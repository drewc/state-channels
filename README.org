#+TITLE:  State Channels Library

(C) MUKN  2022, 2023

This fork is for demonstrations and pull requests for the master repository. It attempts to be in a working state and may be self contained regarding upstream compilers such as =gerbil=.

* Installation & Usage

Right now, <2023-03-22 Wed>, we need to build our own Gerbil. That takes 15+ minutes on my Thinkpad Yoga so expect a wee bit of a wait.

** Build

#+begin_src bash :results verbatim :wrap example :session README-shell
  # Choose whatever directory you want to run from
  cd /tmp/ ; rm -rf state-channels

  # Clone it! Shallow is fine
  git clone --depth=1 https://github.com/drewc/state-channels.git

  # This makes a gerbil to compile with that accepts JS
  cd state-channels ; ./bin/make
#+end_src


** Run the executables

There are 3 different forms of what was built.

 1) =./bin/exe= :: A binary executable that runs the =mp1_1= test with fake sockets.

    #+begin_src bash :results verbatim :wrap example :session README-shell
      ./bin/exe | (head -n6 ; tail -n3)
    #+end_src
    =>
    #+begin_example
      ---
      PID   NAME   USER    PEER  SELF
      0h_   HOST1  system  (_)   _
      rl:
      transfer PR1=>GR1 (dupont 5) ([31;49mS[39;49m smith durand)[31;49m[39;49m
      out:
    #+end_example

 2) =./js/bin/exe= :: The same code as the binary compiled to JavaScript with a *Node.js* shebang.

    #+begin_src bash :results verbatim :wrap example :session README-shell
      head -n1 ./js/bin/exe
      ./js/bin/exe | (head -n6 ; tail -n3)
    #+end_src
=>
    #+begin_example
    #!/usr/bin/env node
    ---
    PID   NAME   USER    PEER  SELF
    0h_   HOST1  system  (_)   _
    rl:
    transfer PR1=>GR1 (dupont 5) ([31;49mS[39;49m smith durand)[31;49m[39;49m
    out:
    #+end_example

 3) =./html/exe.html= :: An *HTML* version of the JS script. Open that file in a browser and look at the console.

    #+begin_src bash :results verbatim :wrap example :session README-shell
      head -n3 ./html/exe.html
      head -n7 ./html/exe.html| tail -n2
    #+end_src
    =>
    #+begin_example
      <!doctype html>
      <head><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body><script>
      // File generated by Gambit v4.9.4
      _z = (s) => {
      var leng = s.length;
    #+end_example


* Github

#+begin_src sh
  git@github.com:drewc/state-channels.git
#+end_src

* Emacs

#+begin_src emacs-lisp
  (defun state-channels/create-new-log ()
    (interactive)
    (let ((org-static-blog-drafts-directory "~/me/MuKn/src/state-channels/doc/log"))
      (org-static-blog-create-new-draft)))
#+end_src
